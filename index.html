<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Speech Detection</title>
</head>
<body>

  <div class="words" contenteditable>
  </div>

<script>
  //—Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–∏ —Ä–µ—á–∏ –≤ –±—Ä–∞—É–∑–µ—Ä–µ.
  window.SpeechRecognition = window.SpeechRecognition || window. webkitSpeechRecognition; // –≥–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è, –∫–æ—Ç–æ—Ä–∞—è –∂–∏–≤–µ—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ –∏ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø–æ–≤–µ—Ä—Ö –æ–∫–Ω–∞.

  const recognition = new SpeechRecognition();// –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏
  recognition.interimResults = true;
  recognition.lang = 'en-US';
  
  // –¥–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –∫–∞–∂–¥—ã–π —Ä–∞–∑ —Å–æ–∑–¥–∞–≤–∞–ª—Å—è –Ω–æ–≤—ã–π –ø–∞—Ä–∞–≥—Ä–∞—Ñ –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ä–µ—á–∏ 
  let p = document.createElement('p');
  const words = document.querySelector('.words');
  words.appendChild(p); 

  recognition.addEventListener('result', e => {
    // console.log(e.results);
    const transcript = Array.from(e.results) // –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–ª–∏ –≤ –º–∞—Å—Å–∏–≤, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –º–∞—Å—Å–∏–≤–æ–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
      .map(result => result[0]) // –±–µ—Ä–µ–º –ø–µ—Ä–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å –∫–∞–∂–¥–æ–≥–æ —Å–ø–∏—Å–∫–∞
      .map(result => result.transcript) // –≤–µ—Ä–Ω—É–ª–∏ –∏ –æ—Ç–æ–±—Ä–∞–∑–∏–ª–∏
      .join('');// –æ–±—ä–µ–¥–∏–Ω–∏–ª–∏ —Å—Ç—Ä–æ–∫–∏

      //console.log(transcript);

      const poopScript = transcript.replace(/poop|poo|shit|dump/gi, 'üí©');
      p.textContent = poopScript;

      if (e.results[0].isFinal) { // isFinal –≥–æ–≤–æ—Ä–∏—Ç –Ω–∞–º, —á–µ–ª–æ–≤–µ–∫ –∑–∞–∫–æ–Ω—á–∏–ª –ª–∏ –≥–æ–≤–æ—Ä–∏—Ç—å —ç—Ç–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ.
        p = document.createElement('p');
        words.appendChild(p);
      }
  });

  recognition.addEventListener('end', recognition.start);

  recognition.start();

</script>


  <style>
    html {
      font-size: 10px;
    }

    body {
      background: #ffc600;
      font-family: 'helvetica neue';
      font-weight: 200;
      font-size: 20px;
    }

    .words {
      max-width: 500px;
      margin: 50px auto;
      background: white;
      border-radius: 5px;
      box-shadow: 10px 10px 0 rgba(0,0,0,0.1);
      padding: 1rem 2rem 1rem 5rem;
      background: -webkit-gradient(linear, 0 0, 0 100%, from(#d9eaf3), color-stop(4%, #fff)) 0 4px;
      background-size: 100% 3rem;
      position: relative;
      line-height: 3rem;
    }
    
    p {
      margin: 0 0 3rem;
    }

    .words:before {
      content: '';
      position: absolute;
      width: 4px;
      top: 0;
      left: 30px;
      bottom: 0;
      border: 1px solid;
      border-color: transparent #efe4e4;
    }
  </style>

</body>
</html>
